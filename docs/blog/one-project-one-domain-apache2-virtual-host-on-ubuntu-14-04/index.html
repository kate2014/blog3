<!DOCTYPE html><html lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type" /><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><meta charset="utf-8" /><meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport" /><meta content="One project, one domain: Apache2 Virtual Host on Ubuntu 14.04 - Tommy Ku&#39;s Method Stub - Random thoughts, stories and tutorials of a web dev" name="title" /><meta content="Web developer Tommy Ku talks about his experience in work, learning and life." name="description" /><meta content="Tommy Ku" name="author" /><meta content="One project, one domain: Apache2 Virtual Host on Ubuntu 14.04 - Tommy Ku&#39;s Method Stub - Random thoughts, stories and tutorials of a web dev" property="og:title" /><meta content="article" property="og:type" /><title>One project, one domain: Apache2 Virtual Host on Ubuntu 14.04 - Tommy Ku&#39;s Method Stub</title><link href="/style/gutenberg.css" rel="stylesheet" /><link href="/style/tomorrow-night-eighties.css" rel="stylesheet" /><meta content="Nanoc 4.2.3" name="generator" /></head><body><header><h2><img class="author" src="/assets/images/author.jpg" />Tommy Ku's Method Stub</h2><p><i>Reading and thinking</i></p></header><nav><a href="/">Index</a><a href="https://gh.tommyku.com">About Me</a><a href="https://angel.co/tommyku">AngelList</a><a href="https://hk.linkedin.com/in/tommy-ku-65aba999">LinkedIn</a></nav><main id="main"><section id="meta"><h1>One project, one domain: Apache2 Virtual Host on Ubuntu 14.04</h1><i>Written on 2015.01.20</i></section><section id="content">
<p>Sometimes I just want one domain + one server for each project in my local environment.</p>

<p>Be you a workaholic or not, you may be like me who have dozen of folders in your Apache server’s DocumentRoot. As time goes by, more and more projects get created and store in that particular folder and it starts to look messy. Oh, more than that, it tortues you whenever you run your app: <code>http://localhost/this-project</code>, <code>http://localhost/that-project</code>, or <code>http://localhost/stupidly-long-project-name</code>.</p>

<blockquote>
  <p><em>“With great power comes great responsibility.”</em>
<strong>Uncle Ben</strong></p>
</blockquote>

<p>The more the projects you have, the more you should organize them well with nice-looking URL free of <code>http://localhost</code>. <code>php artisan serve</code> (i.e. start another server from the app) solves half of the problem, as you may want to access any of your projects through port 80.</p>

<p>With virtual host on Apache2 web server it is possible to access your app from <code>http://this-project.lo</code> or <code>http://that-project.lo</code>, or <code>http://slpn.lo</code> (stupidly long project name) without changing any of the directory structure. This is called <a href="http://httpd.apache.org/docs/2.2/vhosts/name-based.html">Name-based Virtual Hosts</a>. As its name suggests, the server determines what you are requesting according to the hostname the client includes in HTTP header. Another way is IP-based Virtual Hosts, which you probably find it less favorable because you want to identify different sites by names, not IP.</p>

<blockquote>
  <p>For your information, virtual hosts is a way to get multiple websites running on the same server in web hosting company. But we are more excited about running multiple sites <em>locally</em> in this article.</p>
</blockquote>

<h4 id="the-settings">The settings</h4>

<p>Let there be a project located at DocumentRoot <code>/var/www/html/the-project</code>, and we want to access this project from <code>tp.lo</code>, meaning “the-project from localhost”.</p>

<blockquote>
  <p>.lo is to date not a valid Internet TLD. Don’t worry about using virtual host this way will fence off yourself from a proper website from the Internet</p>
</blockquote>

<p>We are forking the default settings of <code>localhost</code>.</p>

<pre><code class="language-bash">sudo cp /etc/apache2/sites-available/000-default.conf /etc/apache2/sites-available/tp.lo.conf
</code></pre>

<p>Fire up a text editor and open <code>tp.lo.conf</code>. If you screw this step up, you can always copy <code>000-default.conf</code> again.</p>

<pre><code class="language-apache">&lt;VirtualHost *:80&gt;
	ServerName tp.lo
	DocumentRoot /var/www/html/the-project

	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined
&lt;/VirtualHost&gt;
</code></pre>

<p>There are 2 things you want to modifty: <code>ServerName</code> and <code>DocumentRoot</code>. Modification to the port number <code>*:80</code> is very much optional. <code>ServerName</code> indicates the domain name you want to use, <code>tp.lo</code> in this example. <code>DocumentRoot</code> tells the web server where your website is, we already know the project is located at <code>/var/www/html/the-project</code> so fill that as is.</p>

<h4 id="bring-the-site-up">Bring the site up</h4>

<p>The setup is almost done but we need to notify the web server we have a new virtual host and tell the operating system where to look at with the domain name <code>tp.lo</code>, which is probably not listed in any DNS.</p>

<pre><code class="language-bash">sudo a2ensite /etc/apache2/sites-available/tp.lo.conf
sudo service apache2 restart
</code></pre>

<p>Now Apache2 knows about this virtual host thing. Next, append the following line to <code>/etc/hosts</code>.</p>

<pre><code>127.0.0.1    tp.lo
</code></pre>

<p>If you open a browser and go to <code>tp.lo</code>, you may be redirected to a search engine because the browser has not known about your virtural host yet. Go to <code>http://tp.lo</code> if that happens.</p>

<h4 id="bring-it-down">Bring it down</h4>

<p>Next time when you are done with the site and want to remove it, run</p>

<pre><code class="language-bash">sudo a2dissite /etc/apache2/sites-available/tp.lo.conf
sudo service apache2 restart
</code></pre>
</section></main><script src="/js/highlight.pack.js" type="text/javascript"></script><script>(function() {
  hljs.initHighlightingOnLoad();

}).call(this);
</script><div id="disqus_thread"></div><script>var disqus_config = function () {
  this.page.url = "https://blog.tommyku.com/blog/one-project-one-domain-apache2-virtual-host-on-ubuntu-14-04/";
  this.page.identifier = "one-project-one-domain-apache2-virtual-host-on-ubuntu-14-04";
};

(function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = '//methodstub.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();</script><noscript>Please enable JavaScript to view the <a ,="" href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-47055557-3', 'auto');
ga('send', 'pageview');</script></body></html>